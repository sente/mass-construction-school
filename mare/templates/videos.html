{% extends "layout.html" %}
{% block header %}{% endblock %} 
{% block body %}

    <div id="playlist">
        {% for s in stats %}

            {% if s.status > 0 %}
                {% if s.status == s.video_id %}
                <div style="display:inline-block;">
                        <a href="/video/?video_id={{s.video.id}}">
                    {% else %}
                <div style="display:inline-block;">
                        <a href="/video/?video_id={{s.video.id}}">
                {% endif %}

                    <strong>{{s.video.title}}</strong><br>

                    <img src="http://isomerica.net/~stu/mare/imgs/{{ 'images2/' + s.video.module + '_small.jpg' }}" />
                    <br />
                    <strong>{{(100*s.watched)//s.video.duration}}%</strong>
                </a>
                <div id="stats_{{s.uid}}" class="progressbar"></div>
            </div>
            {% else %}
            <div style="display:inline-block;">
                    <a href="#" onclick="alert('You must watch the videos in order');return false;";>
                    <strong>{{s.video.title}}</strong><br>

                    <img src="http://isomerica.net/~stu/mare/imgs/{{ 'images2/' + s.video.module + '_small.jpg' }}" />
                    <br />
                    <strong>{{(100*s.watched)//s.video.duration}}%</strong>
                    </a> 
                <div id="stats_{{s.uid}}" class="progressbar"></div>
            </div>
            {% endif %}

        {% endfor %}
    </div>

    <script>
        $(function(){
            {% for s in stats %}
            $('#stats_{{s.uid}}').each(function(){$(this).progressbar({value:{{100*s.watched/s.video.duration}}});})
            {% endfor %}
        });
    </script>

{% endblock %}
